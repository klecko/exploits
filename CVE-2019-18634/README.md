# CVE-2019-18634
## Description
The bug happens at `getln()`, the function in charge of reading user input. When user enters ^U (erase line) and pwfeedback is activated, it attempts to clear the asterisks. If it fails, the remaining buffer size is reset but the current pointer is not, leading to a buffer overflow. It is exploited overflowing structure `user_details` and setting `uid` to 0, making sudo run an arbitrary program as root when asking for a password using askpass.


**Target version:** sudo 1.8.25 on Ubuntu 20.04

**Vulnerable versions:** sudo 1.7.1 to 1.8.30

## Expected output
![photo](expected_output.png)

## References
- https://www.sudo.ws/alerts/pwfeedback.html
