# CVE-2017-11176
## Description
The bug is a double sock_put() in mq_notify which leads to UAF. It is exploited using reallocation for type confusion, stack pivoting and ROP, which finally gets to arbitrary ring-zero code execution. 

**Target kernel:** Linux 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux

**Vulnerable kernels:** < 4.11.9

**Protections:** SMEP enabled, SMAP and KASLR disabled.

It bypasses SMEP disabling it with ROP. The target kernel didn't have KASLR, but the exploit could be easily adapted since getting a leak is possible with the available UAF primitives.

The bug and exploitation are commented and explained in the [exploit](exploit.c). For a more extensive explanation take a look at the first reference. 

## Expected output
![photo](expected_output.png)

## References
- https://blog.lexfo.fr/cve-2017-11176-linux-kernel-exploitation-part1.html
- [Linux source code](https://elixir.bootlin.com/linux/v3.16.36/source), specially [af_netlink.c](https://elixir.bootlin.com/linux/v3.16.36/source/net/netlink/af_netlink.c) and [mqueue.c](https://elixir.bootlin.com/linux/v3.16.36/source/ipc/mqueue.c)

